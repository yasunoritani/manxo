# 継続的な開発のための指針

## ファイル書き込み時の注意点

1. **ファイルサイズを小さく保つ**
   - 大きなファイルを一度に書き込むと失敗する可能性がある
   - 1ファイルあたり2000-3000行程度に抑える
   - 大きなクラスは複数のファイルに分割する（例: protocol_handler.js, protocol_handler_patch.js など）

2. **ファイル書き込みのパターン**
   - 小さなチャンクで書き込む
   - ファイル間の依存関係を明確にする
   - 前のファイルの書き込みが成功してから次に進む

3. **エラー発生時の対応**
   - エラーが発生したら、より小さなチャンクに分割する
   - 依存関係を考慮した順序で再度書き込みを試みる

4. **継続的な状態保持**
   - 進行中の作業は定期的に保存する
   - セッション切断に備えて実装状況をドキュメント化する

## プロジェクト構成の標準

### ディレクトリ構造
```
/src
  /protocol     - プロトコル仕様書
  /mcp-server   - MCPサーバー実装
    /lib        - 共通ライブラリ
  /max-osc-bridge - Max OSCブリッジ実装
```

### モジュール分割の推奨パターン
- 機能単位での分割
- レイヤー単位での分割
- インターフェース定義と実装の分離

## 開発フロー
1. 仕様書の作成
2. インターフェース定義
3. 基本機能の実装
4. 拡張機能の実装
5. テスト・検証

これらの指針に従うことで、開発の継続性を確保し、トークン制限などによる途切れを防止できます。